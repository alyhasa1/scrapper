# 2025-11-05

- Updated `ebay_stock_scraper.py` fallback so STATUS writes default to column I when header lookup fails.
- Authored `scraper_setup_guide.md` documenting environment setup, dependencies, and usage flow for sharing externally.
- Normalized `stock_name` assignment in `load_variants_from_excel` so CLI runs with blank product cells no longer hit `'float' object has no attribute split`.
- **CRITICAL FIX #1**: Enhanced `option_matches()` to handle different seller naming conventions:
  - Added `extract_base_colour()` to strip seller-specific suffixes (e.g., "Silver Black - Greekey" → "silver black", "Silver - Gel Back 59" → "silver")
  - Added `extract_base_size()` to remove imperial measurements from sizes (e.g., "40 x 60 cm (1 ft 4 in x 2 ft)" → "40 x 60 cm")
  - This fixes matching failures when scraping listings from different sellers with different naming formats.
- **CRITICAL FIX #2**: Made variant selection order-agnostic:
  - Some listings have Colour first (group 0) and Size second (group 1), e.g., listing 364946395670
  - Other listings have Size first (group 0) and Colour second (group 1), e.g., listing 363486576357
  - Scraper now dynamically detects group order and processes dimensions in page order
  - Fixes errors when trying to select variants on listings with different group ordering
